module.exports=function(s){"use strict";s.util.linefeed="\n",RegExp.quote=function(s){return s.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&")};var e=require("fs"),t=require("path"),i=require("./grunt/bs-lessdoc-parser.js"),n=require("./grunt/bs-raw-files-generator.js"),r=require("./grunt/shrinkwrap.js");s.initConfig({pkg:s.file.readJSON("package.json"),banner:'/*!\n * Jasny Bootstrap v<%= pkg.version %> (<%= pkg.homepage %>)\n * Copyright 2012-<%= grunt.template.today("yyyy") %> <%= pkg.author %>\n * Licensed under <%= pkg.license.type %> (<%= pkg.license.url %>)\n */\n',jqueryCheck:"if (typeof jQuery === 'undefined') { throw new Error('Jasny Bootstrap\\'s JavaScript requires jQuery') }\n\n",clean:{dist:["dist","docs/dist"],jekyll:["_gh_pages"],assets:["assets/css/*.min.css","assets/js/*.min.js"],jade:["jade/*.jade"]},jshint:{options:{jshintrc:"js/.jshintrc"},grunt:{options:{jshintrc:"grunt/.jshintrc"},src:["Gruntfile.js","grunt/*.js"]},src:{src:"js/*.js"},test:{src:"js/tests/unit/*.js"},assets:{src:["docs/assets/js/application.js","docs/assets/js/customizer.js"]}},jscs:{options:{config:"js/.jscs.json"},grunt:{src:["Gruntfile.js","grunt/*.js"]},src:{src:"js/*.js"},test:{src:"js/tests/unit/*.js"},assets:{src:["docs/assets/js/application.js","docs/assets/js/customizer.js"]}},csslint:{options:{csslintrc:"less/.csslintrc"},src:["dist/css/<%= pkg.name %>.css","docs/assets/css/docs.css","docs/examples/**/*.css"]},concat:{options:{banner:"<%= banner %>\n<%= jqueryCheck %>",stripBanners:!1},bootstrap:{src:["js/transition.js","js/offcanvas.js","js/rowlink.js","js/inputmask.js","js/fileinput.js"],dest:"dist/js/<%= pkg.name %>.js"}},uglify:{options:{report:"min"},bootstrap:{options:{banner:"<%= banner %>"},src:"<%= concat.bootstrap.dest %>",dest:"dist/js/<%= pkg.name %>.min.js"},customize:{options:{preserveComments:"some"},src:["docs/assets/js/vendor/less.min.js","docs/assets/js/vendor/jszip.min.js","docs/assets/js/vendor/uglify.min.js","docs/assets/js/vendor/blob.js","docs/assets/js/vendor/filesaver.js","docs/assets/js/raw-files.min.js","docs/assets/js/customizer.js"],dest:"docs/assets/js/customize.min.js"},docsJs:{options:{preserveComments:"some"},src:["docs/assets/js/vendor/holder.js","docs/assets/js/application.js"],dest:"docs/assets/js/docs.min.js"}},less:{compileCore:{options:{strictMath:!0,sourceMap:!0,outputSourceFiles:!0,sourceMapURL:"<%= pkg.name %>.css.map",sourceMapFilename:"dist/css/<%= pkg.name %>.css.map"},files:{"dist/css/<%= pkg.name %>.css":"less/build/<%= pkg.name %>.less"}},minify:{options:{cleancss:!0,report:"min"},files:{"dist/css/<%= pkg.name %>.min.css":"dist/css/<%= pkg.name %>.css"}}},cssmin:{compress:{options:{keepSpecialComments:"*",noAdvanced:!0,report:"min",selectorsMergeMode:"ie8"},src:["docs/assets/css/docs.css","docs/assets/css/pygments-manni.css"],dest:"docs/assets/css/docs.min.css"}},usebanner:{dist:{options:{position:"top",banner:"<%= banner %>"},files:{src:["dist/css/<%= pkg.name %>.css","dist/css/<%= pkg.name %>.min.css"]}}},csscomb:{options:{config:"less/.csscomb.json"},dist:{files:{"dist/css/<%= pkg.name %>.css":"dist/css/<%= pkg.name %>.css"}},examples:{expand:!0,cwd:"docs/examples/",src:["**/*.css"],dest:"docs/examples/"}},copy:{docs:{expand:!0,cwd:"./dist",src:["{css,js}/*.min.*","css/*.map"],dest:"docs/dist"}},qunit:{options:{inject:"js/tests/unit/phantom.js"},files:"js/tests/index.html"},connect:{server:{options:{port:3e3,base:"."}}},jekyll:{docs:{}},jade:{compile:{options:{pretty:!0,data:function(){var s=t.join(__dirname,"less/build/variables.less"),n=e.readFileSync(s,{encoding:"utf8"}),r=new i(n);return{sections:r.parseFile()}}},files:{"docs/_includes/customizer-variables.html":"docs/jade/customizer-variables.jade","docs/_includes/nav-customize.html":"docs/jade/customizer-nav.jade"}}},validation:{options:{charset:"utf-8",doctype:"HTML5",failHard:!0,reset:!0,relaxerror:["Bad value X-UA-Compatible for attribute http-equiv on element meta.","Element img is missing required attribute src."]},files:{src:"_gh_pages/**/*.html"}},watch:{src:{files:"<%= jshint.src.src %>",tasks:["jshint:src","qunit"]},test:{files:"<%= jshint.test.src %>",tasks:["jshint:test","qunit"]},less:{files:"less/*.less",tasks:"less"}},replace:{versionNumber:{src:["*.js","*.md","*.json","*.yml","js/*.js"],overwrite:!0,replacements:[{from:s.option("oldver"),to:s.option("newver")}]}},"saucelabs-qunit":{all:{options:{build:process.env.TRAVIS_JOB_ID,concurrency:10,urls:["http://127.0.0.1:3000/js/tests/index.html"],browsers:s.file.readYAML("test-infra/sauce_browsers.yml")}}},exec:{npmUpdate:{command:"npm update --silent"},npmShrinkWrap:{command:"npm shrinkwrap --dev"}}}),require("load-grunt-tasks")(s,{scope:"devDependencies"}),s.registerTask("validate-html",["jekyll","validation"]);var c=[];process.env.TWBS_TEST&&"core"!==process.env.TWBS_TEST||(c=c.concat(["dist-css","csslint","jshint","jscs","qunit","build-customizer-html"])),process.env.TWBS_TEST&&"validate-html"!==process.env.TWBS_TEST||c.push("validate-html"),"undefined"==typeof process.env.SAUCE_ACCESS_KEY||process.env.TWBS_TEST&&"sauce-js-unit"!==process.env.TWBS_TEST||(c.push("connect"),c.push("saucelabs-qunit")),s.registerTask("test",c),s.registerTask("dist-js",["concat","uglify"]),s.registerTask("dist-css",["less","cssmin","csscomb","usebanner"]),s.registerTask("dist-docs","copy:docs"),s.registerTask("dist",["clean:dist","dist-css","dist-js","dist-docs"]),s.registerTask("default",["dist","build-customizer"]),s.registerTask("docs",["jekyll","dist-docs"]),s.registerTask("change-version-number","replace"),s.registerTask("build-customizer",["build-customizer-html","build-raw-files"]),s.registerTask("build-customizer-html","jade"),s.registerTask("build-raw-files","Add scripts/less files to customizer.",function(){var e=s.template.process("<%= banner %>");n(e)}),s.registerTask("update-shrinkwrap",["exec:npmUpdate","exec:npmShrinkWrap","∆update-shrinkwrap"]),s.registerTask("∆update-shrinkwrap",function(){r.call(this,s)})};